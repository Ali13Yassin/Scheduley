<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduley</title>

    <!-- Inter Font for professional typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- TailwindCSS Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: { 50: '#FFF5F2', 100: '#FFE8E1', 500: '#CE3602', 600: '#B32F02', 700: '#8B2401' },
                        success: { 50: '#F0FDF4', 500: '#22C55E', 600: '#16A34A' },
                    },
                    fontFamily: { manrope: ['Manrope', 'sans-serif'] },
                }
            }
        }
    </script>

    <!-- Animate.css for micro-interactions -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <!-- Original stylesheets -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/scheduleVisuals.css">
    <link rel="icon" type="image/x-icon" href="../assets/images/S.ico">
</head>

<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen">
    <div id="navbar"></div>

    <!-- Step Progress Bar -->
    <div id="step-progress" class="max-w-4xl mx-auto px-4 py-4 mb-2">
        <div class="flex items-center justify-between relative">
            <!-- Progress line background -->
            <div class="absolute top-5 left-[10%] right-[10%] h-0.5 bg-gray-200 -z-0"></div>
            <!-- Progress line fill -->
            <div id="progress-fill"
                class="absolute top-5 left-[10%] h-0.5 bg-brand-500 transition-all duration-500 -z-0" style="width: 0%">
            </div>

            <!-- Steps -->
            <div class="step-item active" data-step="1">
                <div class="step-circle">1</div>
                <span class="step-label">Import</span>
            </div>
            <div class="step-item" data-step="2">
                <div class="step-circle">2</div>
                <span class="step-label">Select</span>
            </div>
            <div class="step-item" data-step="3">
                <div class="step-circle">3</div>
                <span class="step-label">Edit</span>
            </div>
            <div class="step-item" data-step="4">
                <div class="step-circle">4</div>
                <span class="step-label">Filters</span>
            </div>
            <div class="step-item" data-step="5">
                <div class="step-circle">5</div>
                <span class="step-label">Schedule</span>
            </div>
        </div>
    </div>

    <div id="all-container" class="max-w-6xl mx-auto px-4 pb-24">
        <div id="center-container" style="display: block;">
            <!-- Import and data validation stage -->
            <div id="online-import-container" style="display: block;">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Choose data from existing Universities</h2>
                <div id="SUT-online-import" class="course-card uni-card">ElSewedy University of Technology</div>
                <p class="text-gray-600 mt-6 mb-2">Your University isn't here?</p>
                <button id="upload-button" class="btn-secondary">Upload your data instead</button>
            </div>
            <div id="upload-container" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">How this works</h2>
                <p class="text-gray-600 mb-2">Upload a valid csv file containing all the needed course data and we will
                    find you the best schedules</p>
                <p class="text-gray-600 mb-4">You can download the CSV template and fill it with your Universities data
                </p>
                <a href="../assets/data-template.csv" class="text-brand-500 hover:underline font-medium">Download
                    template</a><br>
                <input type="file" id="fileInput" accept=".csv" class="mt-4 mb-4">
                <button id="save-import-button">Next step</button>
                <p class="text-gray-600 mt-6 mb-2">Your University already here?</p>
                <button id="backto-online-import-button" class="btn-secondary">Search for it instead!</button>
            </div>

            <!-- Course selection stage -->
            <div id="course-selection-container" style="display: none;">
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-4 gap-4">
                    <h2 class="text-2xl font-bold text-gray-900">Choose your courses</h2>
                    <span id="selection-counter"
                        class="inline-flex items-center gap-2 px-4 py-2 bg-brand-50 text-brand-600 rounded-full font-semibold text-sm">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path
                                d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" />
                        </svg>
                        <span id="selected-count">0</span> selected
                    </span>
                </div>

                <!-- Enhanced search -->
                <div class="course-search-container relative mb-6">
                    <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"
                        fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <input type="text" id="course-search-input" class="course-search-box pl-12"
                        placeholder="Search by course code or name...">
                    <span id="search-results-count"
                        class="absolute right-4 top-1/2 -translate-y-1/2 text-sm text-gray-500"></span>
                </div>

                <div class="grid-container" id="courseGrid"></div>
                <div class="nav-row">
                    <button id="course-selection-back" class="btn-secondary">Back</button>
                    <button id="show-mycourse-details-button">Next</button>
                </div>
            </div>

            <!-- Course details selection menu -->
            <div id="mycourse-selection-container" style="display: none;">
                <h2 class="text-2xl font-bold text-gray-900 mb-2">Choose a course to edit</h2>
                <p class="text-gray-500 mb-4">Click on a course to remove specific sessions (e.g., full lectures)</p>
                <div class="grid-container" id="mycourseGrid"></div>
                <div class="nav-row">
                    <button id="mycourse-back" class="btn-secondary">Back</button>
                    <button id="show-filter-menu-button">Next</button>
                </div>
            </div>

            <!-- Course details menu -->
            <div id="course-details-container" style="display: none;">
                <!-- Info banner explaining what this screen does -->
                <div class="bg-blue-50 border border-blue-200 p-3 mb-4 rounded-lg">
                    <div class="flex items-start gap-2">
                        <svg class="w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd"
                                d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                                clip-rule="evenodd" />
                        </svg>
                        <div>
                            <h3 class="font-semibold text-blue-800 text-sm">Remove Unavailable Sessions</h3>
                            <p class="text-xs text-blue-600 mt-1">
                                Click on any session to <strong>exclude it</strong> from schedule generation. Hover to
                                preview on the calendar.
                            </p>
                        </div>
                    </div>
                </div>

                <h2 class="text-lg font-bold text-gray-900 mb-3">Edit course sessions</h2>
                <div class="container">
                    <div id="left-panel" class="left-panel">
                        <!-- Sessions will be rendered here by JS -->
                    </div>

                    <div id="right-panel">
                        <div class="empty-preview text-center text-gray-400 py-16">
                            <svg class="w-12 h-12 mx-auto mb-3 text-gray-300" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            <p class="text-sm">Hover over a session to preview</p>
                        </div>
                    </div>
                </div>
                <div class="nav-row mt-4">
                    <button id="course-details-back" class="btn-secondary">Back</button>
                    <button id="save-mycourse-details">Save</button>
                </div>
            </div>

            <!-- Filters menu -->
            <div id="filter-selection-menu" style="display: none;">
                <h2 class="text-xl font-bold text-gray-900 mb-1">Customize Your Schedule</h2>
                <p class="text-gray-500 text-sm mb-4">Set your preferences below.</p>

                <div id="filter-container" class="space-y-3">
                    <div id="filter-1" class="filter-group">
                        <div class="filter-group-header">
                            <svg class="w-5 h-5 text-brand-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z"
                                    clip-rule="evenodd" />
                            </svg>
                            <h3>Number of days</h3>
                        </div>
                        <div class="filter-chips">
                            <input type="radio" id="numOfDaysFilter-any-checkbox" name="numOfDays" value="any" checked>
                            <label for="numOfDaysFilter-any-checkbox" class="filter-chip">Any</label>
                            <input type="radio" id="numOfDaysFilter-1days-checkbox" name="numOfDays" value="1">
                            <label for="numOfDaysFilter-1days-checkbox" class="filter-chip">1 Day</label>
                            <input type="radio" id="numOfDaysFilter-2days-checkbox" name="numOfDays" value="2">
                            <label for="numOfDaysFilter-2days-checkbox" class="filter-chip">2 Days</label>
                            <input type="radio" id="numOfDaysFilter-3days-checkbox" name="numOfDays" value="3">
                            <label for="numOfDaysFilter-3days-checkbox" class="filter-chip">3 Days</label>
                            <input type="radio" id="numOfDaysFilter-4days-checkbox" name="numOfDays" value="4">
                            <label for="numOfDaysFilter-4days-checkbox" class="filter-chip">4 Days</label>
                            <input type="radio" id="numOfDaysFilter-5days-checkbox" name="numOfDays" value="5">
                            <label for="numOfDaysFilter-5days-checkbox" class="filter-chip">5 Days</label>
                        </div>
                    </div>
                    <div id="filter-2" class="filter-group">
                        <div class="filter-group-header">
                            <svg class="w-5 h-5 text-brand-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                                    clip-rule="evenodd" />
                            </svg>
                            <h3>Have at least 1 hour gap</h3>
                        </div>
                        <div class="filter-chips">
                            <input type="radio" id="findSchedulesWithGaps-false-checkbox" name="findSchedulesWithGaps"
                                value="false" checked>
                            <label for="findSchedulesWithGaps-false-checkbox" class="filter-chip">Doesn't matter</label>
                            <input type="radio" id="findSchedulesWithGaps-true-checkbox" name="findSchedulesWithGaps"
                                value="true">
                            <label for="findSchedulesWithGaps-true-checkbox" class="filter-chip">Yes</label>
                        </div>
                    </div>
                    <div id="filter-3" class="filter-group">
                        <div class="filter-group-header">
                            <svg class="w-5 h-5 text-brand-500" fill="currentColor" viewBox="0 0 20 20">
                                <path
                                    d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z" />
                            </svg>
                            <h3>Have labs after courses</h3>
                        </div>
                        <div class="filter-chips">
                            <input type="radio" id="checkLabOrTutorialAfterLecture-false-checkbox"
                                name="checkLabOrTutorialAfterLecture" value="false" checked>
                            <label for="checkLabOrTutorialAfterLecture-false-checkbox" class="filter-chip">Doesn't
                                matter</label>
                            <input type="radio" id="checkLabOrTutorialAfterLecture-true-checkbox"
                                name="checkLabOrTutorialAfterLecture" value="true">
                            <label for="checkLabOrTutorialAfterLecture-true-checkbox" class="filter-chip">Yes</label>
                        </div>
                    </div>
                    <div id="filter-4" class="filter-group">
                        <div class="filter-group-header">
                            <svg class="w-5 h-5 text-brand-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd"
                                    d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                                    clip-rule="evenodd" />
                            </svg>
                            <h3>Remove days with 1 session</h3>
                        </div>
                        <div class="filter-chips">
                            <input type="radio" id="removeSingleSessionDays-false-checkbox"
                                name="removeSingleSessionDays" value="false" checked>
                            <label for="removeSingleSessionDays-false-checkbox" class="filter-chip">Doesn't
                                matter</label>
                            <input type="radio" id="removeSingleSessionDays-true-checkbox"
                                name="removeSingleSessionDays" value="true">
                            <label for="removeSingleSessionDays-true-checkbox" class="filter-chip">Yes</label>
                        </div>
                    </div>
                </div>

                <!-- Generate button (Pill Style) -->
                <div class="mt-6 text-center">
                    <button id="processButton" class="generate-pill-btn" style="--clr: #D74C4C">
                        <span class="button__icon-wrapper">
                            <svg viewBox="0 0 14 15" fill="none" xmlns="http://www.w3.org/2000/svg"
                                class="button__icon-svg" width="10">
                                <path
                                    d="M13.376 11.552l-.264-10.44-10.44-.24.024 2.28 6.96-.048L.2 12.56l1.488 1.488 9.432-9.432-.048 6.912 2.304.024z"
                                    fill="currentColor"></path>
                            </svg>
                            <svg viewBox="0 0 14 15" fill="none" width="10" xmlns="http://www.w3.org/2000/svg"
                                class="button__icon-svg button__icon-svg--copy">
                                <path
                                    d="M13.376 11.552l-.264-10.44-10.44-.24.024 2.28 6.96-.048L.2 12.56l1.488 1.488 9.432-9.432-.048 6.912 2.304.024z"
                                    fill="currentColor"></path>
                            </svg>
                        </span>
                        Generate Schedule
                    </button>
                </div>

                <div class="nav-row mt-4">
                    <button id="filter-back" class="btn-secondary">Back</button>
                </div>
            </div>
        </div>

        <div id="processOverlay">
            <div class="processMessage">
                <h2 id="process-title">Finding your Schedule</h2>
            </div>
        </div>

        <!-- Schedule confirmation menu -->
        <div id="schedule-details-container" style="display: none;">
            <div id="results-summary">
                <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                    <strong id="total-schedules" class="text-lg">Found 0 schedules</strong>
                    <span id="current-index-label" class="text-gray-500">â€“</span>
                    <span id="active-filter-label" class="text-blue-600 font-medium"></span>
                </div>
                <div id="day-off-groups" class="flex flex-wrap gap-2 items-center mt-4 sm:mt-0">
                    <span class="text-gray-500 text-sm">Day off:</span>
                    <button id="dayoff-SUN" class="dayoff-btn" type="button">Sun off (0)</button>
                    <button id="dayoff-MON" class="dayoff-btn" type="button">Mon off (0)</button>
                    <button id="dayoff-TUE" class="dayoff-btn" type="button">Tue off (0)</button>
                    <button id="dayoff-WED" class="dayoff-btn" type="button">Wed off (0)</button>
                    <button id="dayoff-THU" class="dayoff-btn" type="button">Thu off (0)</button>
                    <button id="clear-dayoff-filter" type="button"
                        class="text-sm text-gray-500 hover:text-brand-500">Clear</button>
                </div>
            </div>

            <div id="schedule-container"></div>

            <!-- Schedule Action Buttons -->
            <div class="schedule-actions">
                <button id="schedule-stage-back-bottom" class="back-filters-btn">
                    <svg class="inline w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                    Back to Filters
                </button>

                <!-- Center Nav Buttons (Strict Style) -->
                <div class="styled-wrapper">
                    <!-- Previous -->
                    <button id="back" class="button">
                        <div class="button-box">
                            <span class="button-elem">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 46 40">
                                    <path
                                        d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z">
                                    </path>
                                </svg>
                            </span>
                        </div>
                    </button>
                    <!-- Next -->
                    <button id="next" class="button next">
                        <div class="button-box">
                            <span class="button-elem">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 46 40">
                                    <path
                                        d="M46 20.038c0-.7-.3-1.5-.8-2.1l-16-17c-1.1-1-3.2-1.4-4.4-.3-1.2 1.1-1.2 3.3 0 4.4l11.3 11.9H3c-1.7 0-3 1.3-3 3s1.3 3 3 3h33.1l-11.3 11.9c-1 1-1.2 3.3 0 4.4 1.2 1.1 3.3.8 4.4-.3l16-17c.5-.5.8-1.1.8-1.9z">
                                    </path>
                                </svg>
                            </span>
                        </div>
                    </button>
                </div>

                <button id="save-schedule-button" class="save-btn">
                    <div class="button-wrapper">
                        <div class="text">Save</div>
                        <span class="icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor"
                                stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24">
                                <path
                                    d="M12 15V3m0 12l-4-4m4 4l4-4M2 17l.621 2.485A2 2 0 0 0 4.561 21h14.878a2 2 0 0 0 1.94-1.515L22 17">
                                </path>
                            </svg>
                        </span>
                    </div>
                </button>
            </div>
        </div>

        <div id="errorOverlay">
            <div id="Errblur" class="errorMessage">
                <h2 id="alert-title">Error Occurred!</h2>
                <p id="alert-text">Something went wrong. Please try again later.</p>
                <button id="close-alert">Close</button>
            </div>
        </div>
    </div>
    <div id="footer"></div>
    <script type="module" src="../js/scheduleFinderMain.js"></script>
</body>

</html>